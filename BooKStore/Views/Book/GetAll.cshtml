@model IEnumerable<BooKStore.Models.DTO.Book>
@{
}
<style>
    .search {
        background-color: #aa048b;
        color: white;
       /* padding: 14px 20px;
        margin: 8px 0;
        border: none;
        cursor: pointer;
        width: 100%;*/
    }
</style>

<div class="container pt-3">
    
  
    <div class="row">
        <div class="col-md-12">
            <h3 style="text-align:center">Books Lists</h3>
            <div class="row">
                @if (User.IsInRole("admin"))
                {
                    <div class="col-md-12" style="text-align:right">
                        <a class="btn btn-dark" href="/Book/Add">+ Add </a>
                    </div>
                }
            </div>
            <br />

            <form class="form-inline"  action="/Book/GetAll">
                <table>
                    <tr>
                        <td class="search"> @Html.Label("Search")</td>
                        <td>
                            @Html.TextBox("Search", ViewBag.search as string, new { @class="form-control mr-1", placeholder="Search" })
                       </td>
                        <td>
                            <button type="submit" class="btn btn-primary">GO</button>
                        </td>
                    </tr>
                </table>
               
                
            </form>

          <table  class="table table-stripped table-bordered">
              <tr>
                <th class="table-dark">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                            <a href="/Book/GetAll?SortColumn=Title&IconClass=fa-sort-asc&PageNo=1">Title</a>
                        if (ViewBag.SortColumn == "Title")
                    {
                       <i class="fa @ViewBag.IconClass"></i>
                    }
                }
                else
                {
                            <a href="/Book/GetAll?SortColumn=Title&IconClass=fa-sort-desc&PageNo=1">Title</a>
                        if (ViewBag.SortColumn == "Title")
                     {
                        <i class="fa @ViewBag.IconClass"></i>
                     }
                }
            </th>

                    <th class="table-dark">
                        @if (ViewBag.IconClass == "fa-sort-desc")
                        {
                            <a href="/Book/GetAll?SortColumn=Image&IconClass=fa-sort-asc&PageNo=1">Image</a>
                            if (ViewBag.SortColumn == "Image")
                            {
                                <i class="fa @ViewBag.IconClass"></i>
                            }
                        }
                        else
                        {
                            <a href="/Book/GetAll?SortColumn=Image&IconClass=fa-sort-desc&PageNo=1">Image</a>
                            if (ViewBag.SortColumn == "Image")
                            {
                                <i class="fa @ViewBag.IconClass"></i>
                            }
                        }
                    </th>
                <th class="table-dark">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                            <a href="/Book/GetAll?SortColumn=GenreName&IconClass=fa-sort-asc&PageNo=1">Genre</a>
                            if (ViewBag.SortColumn == "GenreName")
                    {
                      <i class="fa @ViewBag.IconClass"></i>
                    }
                }
                else
                {
                            <a href="/Book/GetAll?SortColumn=GenreName&IconClass=fa-sort-desc&PageNo=1">Genre</a>
                            if (ViewBag.SortColumn == "GenreName")
                    {
                       <i class="fa @ViewBag.IconClass"></i>
                    }
                }
            </th>
                <th class="table-dark">
               @if (ViewBag.IconClass == "fa-sort-desc")
                {
                            <a href="/Book/GetAll?SortColumn=Isbn&IconClass=fa-sort-asc&PageNo=1">Isbn</a>
                            if (ViewBag.SortColumn == "Isbn")
                 {
                     <i class="fa @ViewBag.IconClass"></i>
                 }
                }
               else
               {
                            <a href="/Book/GetAll?SortColumn=Isbn&IconClass=fa-sort-desc&PageNo=1">Isbn</a>
                            if (ViewBag.SortColumn == "Isbn")
                  {
                    <i class="fa @ViewBag.IconClass"></i>
                  }
               }
            </th>
                <th class="table-dark">
               @if (ViewBag.IconClass == "fa-sort-desc")
               {
                            <a href="/Book/GetAll?SortColumn=TotalPages&IconClass=fa-sort-asc&PageNo=1">Total Pages</a>
                            if (ViewBag.SortColumn == "TotalPages")
                   {
                      <i class="fa @ViewBag.IconClass"></i>
                   }
               }
               else
               {
                            <a href="/Book/GetAll?SortColumn=TotalPages&IconClass=fa-sort-desc&PageNo=1">Total Pages</a>
                            if (ViewBag.SortColumn == "TotalPages")
                  {
                     <i class="fa @ViewBag.IconClass"></i>
                  }
               }
            </th>
                <th class="table-dark">
               @if (ViewBag.IconClass == "fa-sort-desc")
               {
                            <a href="/Book/GetAll?SortColumn=AuthorName&IconClass=fa-sort-asc&PageNo=1">Author</a>
                            if (ViewBag.SortColumn == "AuthorName")
                   {
                     <i class="fa @ViewBag.IconClass"></i>
                   }
               }
               else
               {
                            <a href="/Book/GetAll?SortColumn=AuthorName&IconClass=fa-sort-desc&PageNo=1">Author</a>
                            if (ViewBag.SortColumn == "AuthorName")
                {
                    <i class="fa @ViewBag.IconClass"></i>
                }
               }
             </th>
                    <th class="table-dark">
                        @if (ViewBag.IconClass == "fa-sort-desc")
                        {
                            <a href="/Book/GetAll?SortColumn=PublisherName&IconClass=fa-sort-asc&PageNo=1">Publisher</a>
                            if (ViewBag.SortColumn == "PublisherName")
                            {
                                <i class="fa @ViewBag.IconClass"></i>
                            }
                        }
                        else
                        {
                            <a href="/Book/GetAll?SortColumn=PublisherName&IconClass=fa-sort-desc&PageNo=1">Publisher</a>
                            if (ViewBag.SortColumn == "PublisherName")
                            {
                                <i class="fa @ViewBag.IconClass"></i>
                            }
                        }
                    </th>
                    <th class="table-dark">
                        @if (ViewBag.IconClass == "fa-sort-desc")
                        {
                            <a href="/Book/GetAll?SortColumn=Price&IconClass=fa-sort-asc&PageNo=1">Price</a>
                            if (ViewBag.SortColumn == "Price")
                            {
                                <i class="fa @ViewBag.IconClass"></i>
                            }
                        }
                        else
                        {
                            <a href="/Book/GetAll?SortColumn=Price&IconClass=fa-sort-desc&PageNo=1">Price</a>
                            if (ViewBag.SortColumn == "Price")
                            {
                                <i class="fa @ViewBag.IconClass"></i>
                            }
                        }
                    </th>
                    <th class="table-dark"></th>
                @if (User.IsInRole("admin"))
                {
                        <th class="table-dark">Action</th>
                }
             </tr>
                @*<thead class="table-dark">
                    <tr>
                        <th>Title</th>
                        <th>Genre</th>
                        <th>Isbn</th>
                        <th>Total Pages</th>
                        <th>Author</th>
                        <th>Publisher</th>
                        @if (User.IsInRole("admin"))
                         {
                             <th>Action</th>
                         }
                    </tr>
                </thead>*@
                <tbody class="">
                    @foreach(var item in Model){
                    <tr>
                            <td>@item.Title</td>
                            <td> <img src="/media/books/@item.Image" width="100" alt="Image" /></td>
                            <td>@item.GenreName</td>
                            <td>@item.Isbn</td>
                            <td>@item.TotalPages</td>
                            <td>@item.AuthorName</td>
                            <td>@item.PublisherName</td>
                            <td>@item.Price.ToString("C2")</td>
                            <td>
                                <a class="btn btn-primary" asp-controller="Cart" asp-action="Add" asp-route-id="@item.Id">Add to cart</a>

                            </td>
                            @if (User.IsInRole("admin"))
                            {
                                <td>
                                    <a class="btn btn-success" href="/Book/Update?id=@item.Id"><i class="bi bi-pen"></i>Edit</a> |
                                    <a class="btn btn-danger" onclick="if(!confirm('are you sure you want to delete this')){return false}" href="/Book/Delete?id=@item.Id"><i class="bi bi-trash"></i>Delete</a>
                                </td>
                            }
                           
                    </tr>
                    }
                </tbody>

                <tr>
                    <td colspan="9">
                        @{
                            int PrevPageNo = ViewBag.PageNo - 1;
                            if (PrevPageNo <= 0)
                            {
                                PrevPageNo = 1;
                            }

                            int NextPageNo = ViewBag.PageNo + 1;
                            if (NextPageNo > ViewBag.NoOfPages)
                            {
                                NextPageNo = ViewBag.NoOfPages;
                            }
                        }
                        <ul class="pagination justify-content-center">
                            <li class="page-item">
                                <a class="page-link" href="/Book/GetAll?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@PrevPageNo">Prev</a>
                            </li>
                            @for (int i = 0; i < ViewBag.NoOfPages; i++)
                            {
                                if ((i + 1) == ViewBag.PageNo)
                                {
                                    <li class="page-item active">
                                        <a class="page-link" href="/Book/GetAll?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@(i + 1)">@(i + 1)</a>
                                    </li>
                                }
                                else
                                {
                                    <li class="page-item">
                                        <a class="page-link" href="/Book/GetAll?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@(i + 1)">@(i + 1)</a>
                                    </li>
                                }
                            }
                            <li class="page-item">
                                <a class="page-link" href="/Book/GetAll?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@NextPageNo">Next</a>
                            </li>
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>

